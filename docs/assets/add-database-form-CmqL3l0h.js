var Ue=Object.defineProperty;var Ke=(t,e,s)=>e in t?Ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var oe=(t,e,s)=>Ke(t,typeof e!="symbol"?e+"":e,s);import{s as G}from"./chunk-DZLz74EQ.js";import{t as We}from"./react-cj45iF1i.js";import{ft as He,w as Me,wn as h}from"./cells-CeDLVlyC.js";import{A as p,E as v,F as m,O as re,_ as ue,i as Qe,m as Ge,z as d}from"./zod-U2NFpcFA.js";import{t as be}from"./compiler-runtime-bbSa6V1W.js";import{r as ie}from"./useLifecycle-Rh0PP8AP.js";import{t as Ve}from"./_createAggregator-BwwUYFSi.js";import{d as ze}from"./hotkeys-BxvS_drY.js";import{t as Je}from"./jsx-runtime-srqCRIcI.js";import{t as ae}from"./button-C3DbbTE3.js";import{t as fe}from"./cn-BaXqCYqP.js";import{c as Ye,i as Xe,n as Ze,r as et,s as tt,t as st}from"./select-C3lT2mrt.js";import{t as nt}from"./circle-plus-ChnfwSuu.js";import{a as ce,c as ge,o as ot,p as rt,r as it,t as at}from"./dropdown-menu-BZzIne4N.js";import{n as ct}from"./DeferredRequestRegistry-Ccjmqswm.js";import{o as lt,r as dt}from"./input-DLOryQh1.js";import{a as ht,c as pt,i as mt,n as ut,o as bt,p as ft,r as gt,s as yt,u as St}from"./form-DUdOrxYS.js";import{a as _t,c as wt,l as xt,n as $t,r as kt,t as Ct}from"./dialog-ClIOAWpQ.js";import{n as At}from"./ImperativeModal-ClGQ4GXE.js";import{n as jt}from"./useAsyncData-CpUo9WyH.js";import{t as vt}from"./links-hfBoJmYS.js";import{o as Rt}from"./focus-KxLnFZmO.js";import{o as It,t as Tt,u as i}from"./form-CJBhqjDq.js";import{t as qt}from"./request-registry-DCw8vPju.js";import{n as Dt,t as Lt}from"./write-secret-modal-3icquJc3.js";var Pt=Ve(function(t,e,s){t[s?0:1].push(e)},function(){return[[],[]]});function $(){return d().optional().describe(i.of({label:"Password",inputType:"password",placeholder:"password",optionRegex:".*password.*"}))}function le(t,e){let s=d();return s=e?s.nonempty():s.optional(),s=s.describe(i.of({label:t||"Token",inputType:"password",placeholder:"token",optionRegex:".*token.*"})),s}function V(){return d().optional().describe(i.of({label:"Warehouse Name",placeholder:"warehouse",optionRegex:".*warehouse.*"}))}function de(t,e){let s=d();return s=e?s.nonempty():s.optional(),s.describe(i.of({label:t||"URI",optionRegex:".*uri.*"}))}function x(t){return d().nonempty().describe(i.of({label:t||"Host",placeholder:"localhost",optionRegex:".*host.*"}))}function w(){return d().describe(i.of({label:"Database",placeholder:"db name",optionRegex:".*database.*"}))}function Nt(){return d().describe(i.of({label:"Schema",placeholder:"schema name",optionRegex:".*schema.*"}))}function k(){return d().nonempty().describe(i.of({label:"Username",placeholder:"username",optionRegex:".*username.*"}))}function C(t){let e=Qe().describe(i.of({label:"Port",inputType:"number",placeholder:t==null?void 0:t.toString()})).transform(Number).refine(s=>s>=0&&s<=65535,{message:"Port must be between 0 and 65535"});return t===void 0?e:e.default(t)}function ye(){return v().default(!1).describe(i.of({label:"Read Only"}))}const Se=m({type:p("postgres"),host:x(),port:C(5432).optional(),database:w(),username:k(),password:$(),ssl:v().default(!1).describe(i.of({label:"Use SSL"}))}).describe(i.of({direction:"two-columns"})),_e=m({type:p("mysql"),host:x(),port:C(3306),database:w(),username:k(),password:$(),ssl:v().default(!1).describe(i.of({label:"Use SSL"}))}).describe(i.of({direction:"two-columns"})),we=m({type:p("sqlite"),database:w().describe(i.of({label:"Database Path"}))}).describe(i.of({direction:"two-columns"})),xe=m({type:p("duckdb"),database:w().describe(i.of({label:"Database Path"})),read_only:ye()}).describe(i.of({direction:"two-columns"})),$e=m({type:p("motherduck"),database:w().default("my_db").describe(i.of({label:"Database Name"})),token:le()}).describe(i.of({direction:"two-columns"})),ke=m({type:p("snowflake"),account:d().nonempty().describe(i.of({label:"Account",optionRegex:".*snowflake.*"})),warehouse:d().optional().describe(i.of({label:"Warehouse",optionRegex:".*snowflake.*"})),database:w(),schema:d().optional().describe(i.of({label:"Schema",optionRegex:".*snowflake.*"})),username:k(),password:$(),role:d().optional().describe(i.of({label:"Role"}))}).describe(i.of({direction:"two-columns"})),Ce=m({type:p("bigquery"),project:d().nonempty().describe(i.of({label:"Project ID",optionRegex:".*bigquery.*"})),dataset:d().nonempty().describe(i.of({label:"Dataset",optionRegex:".*bigquery.*"})),credentials_json:d().describe(i.of({label:"Credentials JSON",inputType:"textarea"}))}).describe(i.of({direction:"two-columns"})),Ae=m({type:p("clickhouse_connect"),host:x(),port:C(8123).optional(),username:k(),password:$(),secure:v().default(!1).describe(i.of({label:"Use HTTPs"}))}).describe(i.of({direction:"two-columns"})),je=m({type:p("timeplus"),host:x().default("localhost"),port:C(8123).optional(),username:k().default("default"),password:$().default("")}).describe(i.of({direction:"two-columns"})),ve=m({type:p("chdb"),database:w().describe(i.of({label:"Database Path"})),read_only:ye()}).describe(i.of({direction:"two-columns"})),Re=m({type:p("trino"),host:x(),port:C(8080),database:w(),schema:Nt().optional(),username:k(),password:$(),async_support:v().default(!1).describe(i.of({label:"Async Support"}))}).describe(i.of({direction:"two-columns"})),Ie=m({type:p("iceberg"),name:d().describe(i.of({label:"Catalog Name"})),catalog:re("type",[m({type:p("REST"),warehouse:V(),uri:d().optional().describe(i.of({label:"URI",placeholder:"https://",optionRegex:".*uri.*"})),token:le()}),m({type:p("SQL"),warehouse:V(),uri:d().optional().describe(i.of({label:"URI",placeholder:"jdbc:iceberg://host:port/database",optionRegex:".*uri.*"}))}),m({type:p("Hive"),warehouse:V(),uri:de()}),m({type:p("Glue"),warehouse:V(),uri:de()}),m({type:p("DynamoDB"),"dynamodb.profile-name":d().optional().describe(i.of({label:"Profile Name"})),"dynamodb.region":d().optional().describe(i.of({label:"Region"})),"dynamodb.access-key-id":d().optional().describe(i.of({label:"Access Key ID"})),"dynamodb.secret-access-key":d().optional().describe(i.of({label:"Secret Access Key",inputType:"password"})),"dynamodb.session-token":d().optional().describe(i.of({label:"Session Token",inputType:"password"}))})]).default({type:"REST",token:void 0}).describe(i.of({special:"tabs"}))}),Te=m({type:p("datafusion"),sessionContext:v().optional().describe(i.of({label:"Use Session Context"}))}),qe=m({type:p("pyspark"),host:x().optional(),port:C().optional()}),De=m({type:p("redshift"),host:x(),port:C(5439),connectionType:re("type",[m({type:p("IAM credentials"),region:d().describe(i.of({label:"Region"})),aws_access_key_id:d().nonempty().describe(i.of({label:"AWS Access Key ID",inputType:"password",optionRegex:".*aws_access_key_id.*"})),aws_secret_access_key:d().nonempty().describe(i.of({label:"AWS Secret Access Key",inputType:"password",optionRegex:".*aws_secret_access_key.*"})),aws_session_token:d().optional().describe(i.of({label:"AWS Session Token",inputType:"password",optionRegex:".*aws_session_token.*"}))}),m({type:p("DB credentials"),user:k(),password:$()})]).default({type:"IAM credentials",aws_access_key_id:"",aws_secret_access_key:"",region:""}),database:w()}).describe(i.of({direction:"two-columns"})),Le=m({type:p("databricks"),access_token:le("Access Token",!0),server_hostname:x("Server Hostname"),http_path:de("HTTP Path",!0),catalog:d().optional().describe(i.of({label:"Catalog"})),schema:d().optional().describe(i.of({label:"Schema"}))}).describe(i.of({direction:"two-columns"})),Pe=m({type:p("supabase"),host:x(),port:C(5432).optional(),database:w(),username:k(),password:$(),disable_client_pooling:v().default(!1).describe(i.of({label:"Disable Client-Side Pooling"}))}).describe(i.of({direction:"two-columns"})),Ft=re("type",[Se,_e,we,xe,$e,ke,Ce,Ae,je,ve,Re,Ie,Te,qe,De,Le,Pe]);var he="env:";function Gs(t){return t}function z(t){return typeof t=="string"?t.startsWith(he):!1}function pe(t){return`${he}${t}`}function Et(t){return t.replace(he,"")}const Ne={sqlmodel:"SQLModel",sqlalchemy:"SQLAlchemy",duckdb:"DuckDB",clickhouse_connect:"ClickHouse Connect",chdb:"chDB",pyiceberg:"PyIceberg",ibis:"Ibis",motherduck:"MotherDuck",redshift:"Redshift",databricks:"Databricks"};var y=class{constructor(t,e,s){this.connection=t,this.orm=e,this.secrets=s}get imports(){let t=new Set(this.generateImports());switch(this.orm){case"sqlalchemy":t.add("import sqlalchemy");break;case"sqlmodel":t.add("import sqlmodel");break;case"duckdb":t.add("import duckdb");break;case"ibis":t.add("import ibis");break}return t}},Bt=t=>`_${t}`,Ot=class{constructor(){oe(this,"secrets",{})}get imports(){return Object.keys(this.secrets).length===0?new Set:new Set(["import os"])}print(t,e,s){if(t=Bt(t),z(e)){let o=Et(e),n=s?`os.environ.get("${o}", "${s}")`:`os.environ.get("${o}")`;return this.secrets[t]=n,t}if(s!=null){let o=`os.environ.get("${e}", "${s}")`;return this.secrets[t]=o,t}return typeof e=="number"||typeof e=="number"?`${e}`:typeof e=="boolean"?U(e):e?`"${e}"`:""}printInFString(t,e,s){if(e===void 0)return"";if(typeof e=="number")return`${e}`;if(typeof e=="boolean")return U(e);let o=this.print(t,e,s);return o.startsWith('"')&&o.endsWith('"')?o.slice(1,-1):`{${o}}`}printPassword(t,e,s,o){let n=s?this.printInFString.bind(this):this.print.bind(this);return z(t)?n(o||"password",t):n(o||"password",e,t)}getSecrets(){return this.secrets}formatSecrets(){return Object.keys(this.secrets).length===0?"":Object.entries(this.secrets).map(([t,e])=>`${t} = ${e}`).join(`
`)}},Ut=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.connection.ssl?", connect_args={'sslmode': 'require'}":"",e=this.secrets.printPassword(this.connection.password,"POSTGRES_PASSWORD",!0);return h(`
      DATABASE_URL = f"postgresql://${this.secrets.printInFString("username",this.connection.username)}:${e}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}/${this.secrets.printInFString("database",this.connection.database)}"
      engine = ${this.orm}.create_engine(DATABASE_URL${t})
    `)}},Kt=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.connection.ssl?", connect_args={'ssl': {'ssl-mode': 'preferred'}}":"",e=this.secrets.printPassword(this.connection.password,"MYSQL_PASSWORD",!0),s=this.secrets.printInFString("database",this.connection.database);return h(`
      DATABASE_URL = f"mysql+pymysql://${this.secrets.printInFString("username",this.connection.username)}:${e}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}/${s}"
      engine = ${this.orm}.create_engine(DATABASE_URL${t})
    `)}},Wt=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.connection.database?this.secrets.printInFString("database",this.connection.database):"";return h(`
      ${t.startsWith("{")&&t.endsWith("}")?`DATABASE_URL = f"sqlite:///${t}"`:`DATABASE_URL = "sqlite:///${t}"`}
      engine = ${this.orm}.create_engine(DATABASE_URL)
    `)}},Ht=class extends y{generateImports(){return["from snowflake.sqlalchemy import URL"]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"SNOWFLAKE_PASSWORD",!1),e={account:this.secrets.print("account",this.connection.account),user:this.secrets.print("user",this.connection.username),database:this.secrets.print("database",this.connection.database),warehouse:this.connection.warehouse?this.secrets.print("warehouse",this.connection.warehouse):void 0,schema:this.connection.schema?this.secrets.print("schema",this.connection.schema):void 0,role:this.connection.role?this.secrets.print("role",this.connection.role):void 0,password:t};return h(`
      engine = ${this.orm}.create_engine(
        URL(
${J(e,s=>`          ${s}`)},
        )
      )
    `)}},Mt=class extends y{generateImports(){return["import json"]}generateConnectionCode(){let t=this.secrets.printInFString("project",this.connection.project),e=this.secrets.printInFString("dataset",this.connection.dataset);return h(`
      credentials = json.loads("""${this.connection.credentials_json}""")
      engine = ${this.orm}.create_engine(f"bigquery://${t}/${e}", credentials_info=credentials)
    `)}},Qt=class extends y{generateImports(){return[]}generateConnectionCode(){return h(`
      DATABASE_URL = "${this.secrets.printInFString("database",this.connection.database||":memory:")}"
      engine = ${this.orm}.connect(DATABASE_URL, read_only=${U(this.connection.read_only)})
    `)}},Gt=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.secrets.printInFString("database",this.connection.database);return this.connection.token?h(`
      conn = duckdb.connect("md:${t}", config={"motherduck_token": ${this.secrets.printPassword(this.connection.token,"MOTHERDUCK_TOKEN",!1)}})
    `):h(`
        conn = duckdb.connect("md:${t}")
        `)}},Vt=class extends y{generateImports(){return["import clickhouse_connect"]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"CLICKHOUSE_PASSWORD",!1),e={host:this.secrets.print("host",this.connection.host),user:this.secrets.print("user",this.connection.username),secure:this.secrets.print("secure",this.connection.secure),port:this.connection.port?this.secrets.print("port",this.connection.port):void 0,password:this.connection.password?t:void 0};return h(`
      engine = ${this.orm}.get_client(
${J(e,s=>`        ${s}`)},
      )
    `)}},zt=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"TIMEPLUS_PASSWORD",!0);return h(`
      DATABASE_URL = f"timeplus://${this.secrets.printInFString("username",this.connection.username)}:${t}@${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}"
      engine = ${this.orm}.create_engine(DATABASE_URL)
    `)}},Jt=class extends y{generateImports(){return["import chdb"]}generateConnectionCode(){let t=this.secrets.print("database",this.connection.database)||'""';return h(`
      engine = ${this.orm}.connect(${t}, read_only=${U(this.connection.read_only)})
    `)}},Yt=class extends y{generateImports(){return this.connection.async_support?["import aiotrino"]:["import trino.sqlalchemy"]}generateConnectionCode(){let t=this.connection.async_support?"aiotrino":"trino",e=this.connection.schema?`/${this.connection.schema}`:"",s=this.secrets.printInFString("username",this.connection.username),o=this.secrets.printInFString("host",this.connection.host),n=this.secrets.printInFString("port",this.connection.port),a=this.secrets.printInFString("database",this.connection.database),c=this.secrets.printPassword(this.connection.password,"TRINO_PASSWORD",!0);return h(`
      engine = ${this.orm}.create_engine(f"${t}://${s}:${c}@${o}:${n}/${a}${e}")
    `)}},Xt=class extends y{generateImports(){switch(this.connection.catalog.type){case"REST":return["from pyiceberg.catalog.rest import RestCatalog"];case"SQL":return["from pyiceberg.catalog.sql import SqlCatalog"];case"Hive":return["from pyiceberg.catalog.hive import HiveCatalog"];case"Glue":return["from pyiceberg.catalog.glue import GlueCatalog"];case"DynamoDB":return["from pyiceberg.catalog.dynamodb import DynamoDBCatalog"];default:ie(this.connection.catalog)}}generateConnectionCode(){let t={...this.connection.catalog};t=Object.fromEntries(Object.entries(t).filter(([o,n])=>n!=null&&n!==""&&o!=="type"));for(let[o,n]of Object.entries(t))z(n)?t[o]=this.secrets.print(o,n):typeof n=="string"&&(t[o]=`"${n}"`);let e=is(t,o=>`              ${o}`),s=`"${this.connection.name}"`;switch(this.connection.catalog.type){case"REST":return h(`
          catalog = RestCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"SQL":return h(`
          catalog = SqlCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"Hive":return h(`
          catalog = HiveCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"Glue":return h(`
          catalog = GlueCatalog(
            ${s},
            **{
${e}
            },
          )
        `);case"DynamoDB":return h(`
          catalog = DynamoDBCatalog(
            ${s},
            **{
${e}
            },
          )
        `);default:ie(this.connection.catalog)}}},Zt=class extends y{generateImports(){return["from datafusion import SessionContext"]}generateConnectionCode(){return this.connection.sessionContext?h(`
        ctx = SessionContext()
        # Sample table
        _ = ctx.from_pydict({"a": [1, 2, 3]}, "my_table")

        con = ibis.datafusion.connect(ctx)
      `):h(`
      con = ibis.datafusion.connect()
    `)}},es=class extends y{generateImports(){return["from pyspark.sql import SparkSession"]}generateConnectionCode(){return this.connection.host||this.connection.port?h(`
        session = SparkSession.builder.remote(f"sc://${this.secrets.printInFString("host",this.connection.host)}:${this.secrets.printInFString("port",this.connection.port)}").getOrCreate()
        con = ibis.pyspark.connect(session)
      `):h(`
      con = ibis.pyspark.connect()
    `)}},ts=class extends y{generateImports(){return["import redshift_connector"]}generateConnectionCode(){let t=this.secrets.print("host",this.connection.host),e=this.secrets.print("port",this.connection.port),s=this.secrets.print("database",this.connection.database);if(this.connection.connectionType.type==="IAM credentials"){let a=this.secrets.print("aws_access_key_id",this.connection.connectionType.aws_access_key_id),c=this.secrets.print("aws_secret_access_key",this.connection.connectionType.aws_secret_access_key),l=this.connection.connectionType.aws_session_token?this.secrets.print("aws_session_token",this.connection.connectionType.aws_session_token):void 0;return h(`
        con = redshift_connector.connect(
${J({iam:!0,host:t,port:e,region:`"${this.connection.connectionType.region}"`,database:s,access_key_id:a,secret_access_key:c,...l&&{session_token:l}},b=>`          ${b}`)},
        )
      `)}let o=this.connection.connectionType.user?this.secrets.print("user",this.connection.connectionType.user):void 0,n=this.connection.connectionType.password?this.secrets.printPassword(this.connection.connectionType.password,"REDSHIFT_PASSWORD",!1):void 0;return h(`
      con = redshift_connector.connect(
${J({host:t,port:e,database:s,...o&&{user:o},...n&&{password:n}},a=>`          ${a}`)},
      )
    `)}},ss=class extends y{generateImports(){return[]}generateConnectionCode(){let t=this.orm!=="ibis",e=this.secrets.printPassword(this.connection.access_token,"DATABRICKS_ACCESS_TOKEN",t,"access_token"),s=this.secrets.printPassword(this.connection.server_hostname,"DATABRICKS_SERVER_HOSTNAME",t,"server_hostname"),o=this.secrets.printPassword(this.connection.http_path,"DATABRICKS_HTTP_PATH",t,"http_path"),n=this.connection.catalog?this.secrets.printInFString("catalog",this.connection.catalog):void 0,a=this.connection.schema?this.secrets.printInFString("schema",this.connection.schema):void 0,c=`databricks://token:${e}@${s}?http_path=${o}`;return n&&(c+=`&catalog=${n}`),a&&(c+=`&schema=${a}`),this.orm==="ibis"?h(`
        engine = ibis.databricks.connect(
          server_hostname=${s},
          http_path=${o},${n?`
          catalog=${n},`:""}${a?`
          schema=${a},`:""}
          access_token=${e}
        )
      `):h(`
      DATABASE_URL = f"${c}"
      engine = ${this.orm}.create_engine(DATABASE_URL)
      `)}},ns=class extends y{generateImports(){return this.connection.disable_client_pooling?["from sqlalchemy.pool import NullPool"]:[]}generateConnectionCode(){let t=this.secrets.printPassword(this.connection.password,"SUPABASE_PASSWORD",!0),e=this.secrets.printInFString("username",this.connection.username),s=this.secrets.printInFString("host",this.connection.host),o=this.secrets.printInFString("port",this.connection.port),n=this.secrets.printInFString("database",this.connection.database),a=this.connection.disable_client_pooling?", poolclass=NullPool":"";return h(`
      DATABASE_URL = f"postgresql+psycopg2://${e}:${t}@${s}:${o}/${n}?sslmode=require"
      engine = ${this.orm}.create_engine(DATABASE_URL${a})
    `)}},os=class{constructor(){oe(this,"secrets",new Ot)}createGenerator(t,e){switch(t.type){case"postgres":return new Ut(t,e,this.secrets);case"mysql":return new Kt(t,e,this.secrets);case"sqlite":return new Wt(t,e,this.secrets);case"snowflake":return new Ht(t,e,this.secrets);case"bigquery":return new Mt(t,e,this.secrets);case"duckdb":return new Qt(t,e,this.secrets);case"motherduck":return new Gt(t,e,this.secrets);case"clickhouse_connect":return new Vt(t,e,this.secrets);case"timeplus":return new zt(t,e,this.secrets);case"chdb":return new Jt(t,e,this.secrets);case"trino":return new Yt(t,e,this.secrets);case"iceberg":return new Xt(t,e,this.secrets);case"datafusion":return new Zt(t,e,this.secrets);case"pyspark":return new es(t,e,this.secrets);case"redshift":return new ts(t,e,this.secrets);case"databricks":return new ss(t,e,this.secrets);case"supabase":return new ns(t,e,this.secrets);default:ie(t)}}};function rs(t,e){if(!(e in Ne))throw Error(`Unsupported library: ${e}`);Ft.parse(t);let s=new os,o=s.createGenerator(t,e),n=o.generateConnectionCode(),a=s.secrets,c=[...new Set([...a.imports,...o.imports])].sort();c.push("");let l=a.formatSecrets();return l&&c.push(l),c.push(n.trim()),c.join(`
`)}function U(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function J(t,e){return Object.entries(t).filter(([,s])=>s!=null&&s!=="").map(([s,o])=>e(typeof o=="boolean"?`${s}=${U(o)}`:`${s}=${o}`)).join(`,
`)}function is(t,e){return Object.entries(t).filter(([,s])=>s!=null&&s!=="").map(([s,o])=>{let n=`"${s}"`;return e(typeof o=="boolean"?`${n}: ${U(o)}`:`${n}: ${o}`)}).join(`,
`)}var as=G(be(),1),K=G(We(),1),r=G(Je(),1),Fe=(0,K.createContext)({providerNames:[],secretKeys:[],loading:!1,error:void 0,refreshSecrets:ze.NOOP});const cs=()=>(0,K.use)(Fe),ls=t=>{let e=(0,as.c)(14),{children:s}=t,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=[],e[0]=o):o=e[0];let{data:n,isPending:a,error:c,refetch:l}=jt(us,o),b;e[1]===(n==null?void 0:n.secretKeys)?b=e[2]:(b=(n==null?void 0:n.secretKeys)||[],e[1]=n==null?void 0:n.secretKeys,e[2]=b);let u;e[3]===(n==null?void 0:n.providerNames)?u=e[4]:(u=(n==null?void 0:n.providerNames)||[],e[3]=n==null?void 0:n.providerNames,e[4]=u);let f;e[5]!==c||e[6]!==a||e[7]!==l||e[8]!==b||e[9]!==u?(f={secretKeys:b,providerNames:u,loading:a,error:c,refreshSecrets:l},e[5]=c,e[6]=a,e[7]=l,e[8]=b,e[9]=u,e[10]=f):f=e[10];let S;return e[11]!==s||e[12]!==f?(S=(0,r.jsx)(Fe,{value:f,children:s}),e[11]=s,e[12]=f,e[13]=S):S=e[13],S},ds={isMatch:t=>{if(t instanceof ue||t instanceof Ge){let{optionRegex:e}=i.parse(t.description||"");return!!e}return!1},Component:({schema:t,form:e,path:s})=>{let{secretKeys:o,providerNames:n,refreshSecrets:a}=cs(),{openModal:c,closeModal:l}=At(),{label:b,description:u,optionRegex:f=""}=i.parse(t.description||""),[S,A]=Pt(o,g=>new RegExp(f,"i").test(g));return(0,r.jsx)(ht,{control:e.control,name:s,render:({field:g})=>(0,r.jsxs)(bt,{children:[(0,r.jsx)(yt,{children:b}),(0,r.jsx)(gt,{children:u}),(0,r.jsx)(ut,{children:(0,r.jsxs)("div",{className:"flex gap-2",children:[t instanceof ue?(0,r.jsx)(dt,{...g,value:g.value,onChange:g.onChange,className:fe("flex-1")}):(0,r.jsx)(lt,{...g,value:g.value,onChange:g.onChange,className:"flex-1"}),(0,r.jsxs)(at,{children:[(0,r.jsx)(rt,{asChild:!0,children:(0,r.jsx)(ae,{variant:"outline",size:"icon",className:fe(z(g.value)&&"bg-accent"),children:(0,r.jsx)(ct,{className:"h-3 w-3"})})}),(0,r.jsxs)(it,{align:"end",className:"max-h-60 overflow-y-auto",children:[(0,r.jsxs)(ce,{onSelect:()=>{c((0,r.jsx)(Lt,{providerNames:n,onSuccess:_=>{a(),g.onChange(pe(_)),l()},onClose:l}))},children:[(0,r.jsx)(nt,{className:"mr-2 h-3.5 w-3.5"}),"Create a new secret"]}),S.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ge,{}),(0,r.jsx)(ot,{children:"Recommended"})]}),S.map(_=>(0,r.jsx)(ce,{onSelect:()=>g.onChange(pe(_)),children:_},_)),A.length>0&&(0,r.jsx)(ge,{}),A.map(_=>(0,r.jsx)(ce,{onSelect:()=>g.onChange(pe(_)),children:_},_))]})]})]})}),(0,r.jsx)(pt,{})]})})}};function hs(t){return t.provider!=="env"}function ps(t){return t.name}function ms(t){return t.keys}async function us(){let t=await qt.request({}),e=Dt(t.secrets).filter(hs).map(ps);return{secretKeys:t.secrets.flatMap(ms).sort(),providerNames:e}}var W=G(be(),1),Ee=[{name:"PostgreSQL",schema:Se,color:"#336791",logo:"postgres",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"MySQL",schema:_e,color:"#00758F",logo:"mysql",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"SQLite",schema:we,color:"#003B57",logo:"sqlite",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"DuckDB",schema:xe,color:"#FFD700",logo:"duckdb",connectionLibraries:{libraries:["duckdb"],preferred:"duckdb"}},{name:"MotherDuck",schema:$e,color:"#ff9538",logo:"motherduck",connectionLibraries:{libraries:["duckdb"],preferred:"duckdb"}},{name:"Snowflake",schema:ke,color:"#29B5E8",logo:"snowflake",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"ClickHouse",schema:Ae,color:"#2C2C1D",logo:"clickhouse",connectionLibraries:{libraries:["clickhouse_connect"],preferred:"clickhouse_connect"}},{name:"Timeplus",schema:je,color:"#B83280",logo:"timeplus",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"BigQuery",schema:Ce,color:"#4285F4",logo:"bigquery",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"ClickHouse Embedded",schema:ve,color:"#f2b611",logo:"clickhouse",connectionLibraries:{libraries:["chdb"],preferred:"chdb"}},{name:"Trino",schema:Re,color:"#d466b6",logo:"trino",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}},{name:"DataFusion",schema:Te,color:"#202A37",logo:"datafusion",connectionLibraries:{libraries:["ibis"],preferred:"ibis"}},{name:"PySpark",schema:qe,color:"#1C5162",logo:"pyspark",connectionLibraries:{libraries:["ibis"],preferred:"ibis"}},{name:"Redshift",schema:De,color:"#522BAE",logo:"redshift",connectionLibraries:{libraries:["redshift"],preferred:"redshift"}},{name:"Databricks",schema:Le,color:"#c41e0c",logo:"databricks",connectionLibraries:{libraries:["sqlalchemy","sqlmodel","ibis"],preferred:"sqlalchemy"}},{name:"Supabase",schema:Pe,color:"#238F5F",logo:"supabase",connectionLibraries:{libraries:["sqlalchemy","sqlmodel"],preferred:"sqlalchemy"}}],Be=[{name:"Iceberg",schema:Ie,color:"#000000",logo:"iceberg",connectionLibraries:{libraries:["pyiceberg"],preferred:"pyiceberg"}}],bs=t=>{let e=(0,W.c)(14),{onSelect:s}=t,o;e[0]===s?o=e[1]:(o=S=>{let{name:A,schema:g,color:_,logo:R}=S;return(0,r.jsxs)("button",{type:"button",className:"py-3 flex flex-col items-center justify-center gap-1 transition-all hover:scale-105 hover:brightness-110 rounded shadow-sm-solid hover:shadow-md-solid",style:{backgroundColor:_},onClick:()=>s(g),children:[(0,r.jsx)(He,{name:R,className:"w-8 h-8 text-white brightness-0 invert dark:invert"}),(0,r.jsx)("span",{className:"text-white font-medium text-lg",children:A})]},A)},e[0]=s,e[1]=o);let n=o,a;e[2]===n?a=e[3]:(a=Ee.map(n),e[2]=n,e[3]=a);let c;e[4]===a?c=e[5]:(c=(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:a}),e[4]=a,e[5]=c);let l;e[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,r.jsxs)("h4",{className:"font-semibold text-muted-foreground text-lg flex items-center gap-4",children:["Data Catalogs",(0,r.jsx)("hr",{className:"flex-1"})]}),e[6]=l):l=e[6];let b;e[7]===n?b=e[8]:(b=Be.map(n),e[7]=n,e[8]=b);let u;e[9]===b?u=e[10]:(u=(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:b}),e[9]=b,e[10]=u);let f;return e[11]!==c||e[12]!==u?(f=(0,r.jsxs)(r.Fragment,{children:[c,l,u]}),e[11]=c,e[12]=u,e[13]=f):f=e[13],f},fs=[ds],gs=t=>{var me;let e=(0,W.c)(49),{schema:s,onSubmit:o,onBack:n}=t,a;e[0]===s?a=e[1]:(a=It(s),e[0]=s,e[1]=a);let c=s,l;e[2]===c?l=e[3]:(l=St(c),e[2]=c,e[3]=l);let b;e[4]!==a||e[5]!==l?(b={defaultValues:a,resolver:l,reValidateMode:"onChange"},e[4]=a,e[5]=l,e[6]=b):b=e[6];let u=ft(b),f=(me=[...Ee,...Be].find(j=>j.schema===s))==null?void 0:me.connectionLibraries,[S,A]=(0,K.useState)((f==null?void 0:f.preferred)??"sqlalchemy"),{createNewCell:g}=Me(),_=Rt(),R;e[7]!==g||e[8]!==_?(R=j=>{g({code:j,before:!1,cellId:_??"__end__",skipIfCodeExists:!0})},e[7]=g,e[8]=_,e[9]=R):R=e[9];let Y=R,H;e[10]!==Y||e[11]!==o||e[12]!==S?(H=j=>{Y(rs(j,S)),o()},e[10]=Y,e[11]=o,e[12]=S,e[13]=H):H=e[13];let X=H,I;e[14]!==u||e[15]!==X?(I=u.handleSubmit(X),e[14]=u,e[15]=X,e[16]=I):I=e[16];let M;e[17]===Symbol.for("react.memo_cache_sentinel")?(M=(0,r.jsx)(mt,{}),e[17]=M):M=e[17];let T;e[18]!==u||e[19]!==s?(T=(0,r.jsx)(ls,{children:(0,r.jsx)(Tt,{schema:s,form:u,renderers:fs,children:M})}),e[18]=u,e[19]=s,e[20]=T):T=e[20];let q;e[21]===n?q=e[22]:(q=(0,r.jsx)(ae,{type:"button",variant:"outline",onClick:n,children:"Back"}),e[21]=n,e[22]=q);let Z=!u.formState.isValid,D;e[23]===Z?D=e[24]:(D=(0,r.jsx)(ae,{type:"submit",disabled:Z,children:"Add"}),e[23]=Z,e[24]=D);let L;e[25]!==q||e[26]!==D?(L=(0,r.jsxs)("div",{className:"flex gap-2",children:[q,D]}),e[25]=q,e[26]=D,e[27]=L):L=e[27];let ee=st,P;e[28]===Symbol.for("react.memo_cache_sentinel")?(P=j=>A(j),e[28]=P):P=e[28];let N;e[29]===Symbol.for("react.memo_cache_sentinel")?(N=(0,r.jsxs)("div",{className:"flex flex-col gap-1 items-end",children:[(0,r.jsx)(tt,{children:(0,r.jsx)(Ye,{placeholder:"Select a library"})}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"Preferred connection library"})]}),e[29]=N):N=e[29];let te=Ze,se=et,ne=f==null?void 0:f.libraries.map(_s),F;e[30]!==se||e[31]!==ne?(F=(0,r.jsx)(se,{children:ne}),e[30]=se,e[31]=ne,e[32]=F):F=e[32];let E;e[33]!==te||e[34]!==F?(E=(0,r.jsx)(te,{children:F}),e[33]=te,e[34]=F,e[35]=E):E=e[35];let B;e[36]!==ee||e[37]!==S||e[38]!==P||e[39]!==N||e[40]!==E?(B=(0,r.jsx)("div",{children:(0,r.jsxs)(ee,{value:S,onValueChange:P,children:[N,E]})}),e[36]=ee,e[37]=S,e[38]=P,e[39]=N,e[40]=E,e[41]=B):B=e[41];let O;e[42]!==L||e[43]!==B?(O=(0,r.jsxs)("div",{className:"flex gap-2 justify-between",children:[L,B]}),e[42]=L,e[43]=B,e[44]=O):O=e[44];let Q;return e[45]!==T||e[46]!==O||e[47]!==I?(Q=(0,r.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[T,O]}),e[45]=T,e[46]=O,e[47]=I,e[48]=Q):Q=e[48],Q},ys=t=>{let e=(0,W.c)(5),{onSubmit:s}=t,[o,n]=(0,K.useState)(null);if(!o){let l;return e[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,r.jsx)(bs,{onSelect:n}),e[0]=l):l=e[0],l}let a;e[1]===Symbol.for("react.memo_cache_sentinel")?(a=()=>n(null),e[1]=a):a=e[1];let c;return e[2]!==s||e[3]!==o?(c=(0,r.jsx)(gs,{schema:o,onSubmit:s,onBack:a}),e[2]=s,e[3]=o,e[4]=c):c=e[4],c};const Ss=t=>{let e=(0,W.c)(6),{children:s}=t,[o,n]=(0,K.useState)(!1),a;e[0]===s?a=e[1]:(a=(0,r.jsx)(xt,{asChild:!0,children:s}),e[0]=s,e[1]=a);let c;e[2]===Symbol.for("react.memo_cache_sentinel")?(c=(0,r.jsx)(Oe,{onClose:()=>n(!1)}),e[2]=c):c=e[2];let l;return e[3]!==o||e[4]!==a?(l=(0,r.jsxs)(Ct,{open:o,onOpenChange:n,children:[a,c]}),e[3]=o,e[4]=a,e[5]=l):l=e[5],l},Oe=t=>{let e=(0,W.c)(4),{onClose:s}=t,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,r.jsx)(wt,{children:"Add Connection"}),e[0]=o):o=e[0];let n;e[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsxs)(_t,{className:"mb-4",children:[o,(0,r.jsxs)(kt,{children:["Connect to your database or data catalog to query data directly from your notebook. Learn more about how to connect to your database in our"," ",(0,r.jsx)(vt,{href:"https://docs.marimo.io/guides/working_with_data/sql/#connecting-to-a-custom-database",children:"docs."})]})]}),e[1]=n):n=e[1];let a;return e[2]===s?a=e[3]:(a=(0,r.jsxs)($t,{className:"max-h-[75vh] overflow-y-auto",children:[n,(0,r.jsx)(ys,{onSubmit:()=>s()})]}),e[2]=s,e[3]=a),a};function _s(t){return(0,r.jsx)(Xe,{value:t,children:Ne[t]},t)}export{Oe as n,Ss as t};
